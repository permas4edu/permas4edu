$DEFVAR A TYPE = REAL LIST = 1.0
$DEFVAR B TYPE = REAL LIST = 0.002
$DEFVAR D TYPE = REAL LIST = 0.05

$ENTER COMPONENT NAME = DFLT_COMP DOFTYPE = DISP MATH
!
    $SITUATION NAME = STEP_0
       DFLT_COMP SYSTEM = S_STEP_1  CONSTRAINTS = C_STEP_1  LOADING = L_STEP_1  RESULTS = R_STEP_1
    $END SITUATION
!
    $SITUATION NAME = STEP_1
       DFLT_COMP SYSTEM = S_STEP_1  CONSTRAINTS = C_STEP_1  LOADING = L_STEP_1  RESULTS = R_STEP_1
    $END SITUATION

    $STRUCTURE
  
      $NSET NAME = F
         101

      $NSET NAME = GROUND
         100
  
      $NODE NSET = ALL_NODES
         100  0.0   0.0   0.0
         101  1.0   0.0   0.0

      $ELEMENT TYPE = MASS3 ESET = M
           1 101

      $ELEMENT TYPE = SPRING1 ESET = K
           2 100  101
      $ELEMENT TYPE = DAMP1 ESET = D
           3 100  101
      $ELEMENT TYPE = NLSTIFF  ESET = NL_K
           4 100  101
    
    $END STRUCTURE

    $SYSTEM NAME = S_STEP_1
 
        $GEODAT MASS CONT = MASS
          GD_M  1.0
 
        $GEODAT SPRING CONT = STIFF
          GD_K  A(1)

        $GEODAT DAMPER CONT = DAMP
          GD_D  D(1)

        $GEODAT SPRING CONT = FUNCTION
          GD_NL_K 1
    
        $ELPROP
            M    GEODAT = GD_M
            D    GEODAT = GD_D
            K    GEODAT = GD_K
            NL_K GEODAT = GD_NL_K

      $END SYSTEM

      $CONSTRAINTS NAME = C_STEP_1

         $SUPPRESS DOFS = 2,3
           ALL_NODES

         $SUPPRESS DOFS = 1
           GROUND
 
      $END CONSTRAINTS

      $LOADING NAME = L_STEP_1

          $CONLOAD LPAT = 1
             F 1: 1.0

          $FREQLOAD
             LPAT = 1 TYPE = COSINE

      $END LOADING

      $RESULTS NAME = R_STEP_1

          $FREQUENCY PRIMARY = EQUI XTYPE = OMEGA
              0.5  1.5 0.005

      $END RESULTS
 
$EXIT COMPONENT

$ENTER FUNCTION

   $FUNCTION FORMULA FID = 1 DESCRIPTION = 'Duffing'
          F(X) = B(1)*X^3

$EXIT FUNCTION
$FIN

