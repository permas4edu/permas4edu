$DEFVAR DELTA TYPE = REAL LIST = 1.0
$DEFVAR ALPHA TYPE = REAL LIST = 1.0
$DEFVAR BETA  TYPE = REAL LIST = 3.0
$DEFVAR GAMMA TYPE = REAL LIST = 10.0
$DEFVAR OMEGA TYPE = REAL LIST = 1.0
$DEFVAR X0    TYPE = REAL LIST = 2.0
$DEFVAR X0P   TYPE = REAL LIST = 0.0

$ENTER COMPONENT NAME = DFLT_COMP DOFTYPE = DISP MATH

    $SITUATION NAME = STEP_1
       DFLT_COMP SYSTEM = S_STEP_1 CONSTRAINTS = C_STEP_1 LOADING = L_STEP_1 RESULTS = R_STEP_1
    $END SITUATION

    $SITUATION NAME = STEP_2
       DFLT_COMP SYSTEM = S_STEP_1 CONSTRAINTS = C_STEP_1 LOADING = L_STEP_2
    $END SITUATION

    $SITUATION NAME = STEP_3
       DFLT_COMP SYSTEM = S_STEP_1 CONSTRAINTS = C_STEP_1 LOADING = L_STEP_3
    $END SITUATION


    $STRUCTURE

       $NODE NSET = ALL_NODES
         100  0.0  0.0  0.0
         101  1.0  0.0  0.0

       $NSET NAME = GROUND
         100

       $NSET NAME = F
         101

       $ELEMENT TYPE = MASS3 ESET = M
           1  101

       $ELEMENT TYPE = DAMP1 ESET = DELTA
           2  100 101
       $ELEMENT TYPE = SPRING1 ESET = ALPHA
           3  100 101
       $ELEMENT TYPE = NLSTIFF ESET = BETA
           4  100 101

    $END STRUCTURE

    $SYSTEM NAME = S_STEP_1

       $GEODAT MASS CONT = MASS
         GD_M  1.0

       $GEODAT DAMPER CONT = DAMP
         GD_DELTA  DELTA(1)

       $GEODAT SPRING CONT = STIFF
         GD_ALPHA ALPHA(1)

       $GEODAT SPRING CONT = FUNCTION
         GD_BETA  1
 
       $ELPROP
         M     GEODAT = GD_M
         DELTA GEODAT = GD_DELTA
         ALPHA GEODAT = GD_ALPHA
         BETA  GEODAT = GD_BETA
 
    $END SYSTEM

    $CONSTRAINTS NAME = C_STEP_1

       $SUPPRESS DOFS = 2,3
          ALL_NODES
 

       $SUPPRESS DOFS = 1
          GROUND
 
    $END CONSTRAINTS

    $LOADING NAME = L_STEP_1

       $CONLOAD LPAT = 1
         F 1: GAMMA(1)

       $FREQLOAD
         LPAT = 1 TYPE = COSINE

    $END LOADING

    $LOADING NAME = L_STEP_2
    $END LOADING

    $LOADING NAME = L_STEP_3

       $INIVAL DISP 
          F 1: 2.0
       $INIVAL VELO
          F 1: 0.0

       $CONLOAD LPAT = 1
         F 1: GAMMA(1)

       $TRANSLOAD
         LPAT = 1 FUNCTION = 2
       
    $END LOADING

    $RESULTS NAME = R_STEP_1

       $FREQUENCY PRIMARY =  EQUI XTYPE = OMEGA
          0.0  1.0 0.01

    $END RESULTS

$EXIT COMPONENT
$ENTER FUNCTION

    $FUNCTION FORMULA FID = 1
       F(X) = BETA(1)*X^3

    $FUNCTION FORMULA FID = 2
       F(T) = COS(OMEGA(1)*T)

$EXIT FUNCTION
$FIN
